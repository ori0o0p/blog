<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coroutines | Seungwon</title>
  <link rel="stylesheet" href="/blog/assets/css/main.css">
  <link rel="stylesheet" href="/blog/assets/css/syntax.css">
  <script src="/blog/assets/js/theme-toggle.js" defer></script>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Coroutines | Seungwon</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Coroutines" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="코틀린 진영에서의 자바 가상 스레드와 같은 경량 동시성 모델" />
<meta property="og:description" content="코틀린 진영에서의 자바 가상 스레드와 같은 경량 동시성 모델" />
<link rel="canonical" href="http://localhost:4000/blog/language/kotlin-coroutines/" />
<meta property="og:url" content="http://localhost:4000/blog/language/kotlin-coroutines/" />
<meta property="og:site_name" content="Seungwon" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-05-26T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Coroutines" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-05-26T00:00:00+09:00","datePublished":"2024-05-26T00:00:00+09:00","description":"코틀린 진영에서의 자바 가상 스레드와 같은 경량 동시성 모델","headline":"Coroutines","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/language/kotlin-coroutines/"},"url":"http://localhost:4000/blog/language/kotlin-coroutines/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body class="light-theme">
  <div class="site-container">
    <header class="site-header">
  <div class="header-container">
    <div class="site-branding">
      <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="모바일 메뉴 토글">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
      <a href="/blog/" class="site-title">Seungwon</a>
    </div>
    
    <nav class="site-nav">
      <a href="/blog/about/" class="nav-link">소개</a>
      <a href="/blog/archive/" class="nav-link">아카이브</a>
      <button id="theme-toggle" class="theme-toggle" aria-label="테마 전환">
        <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </nav>
  </div>
</header>

    
    <div class="main-container">
      <aside class="sidebar">
        <style>
  /* 클릭 가능한 요소임을 나타내기 위한 커서 스타일 */
  .category-header .folder-icon,
  .category-header .category-link,
  .subcategory-header .folder-icon,
  .subcategory-header .category-link {
    cursor: pointer;
  }
  /* 아이콘과 텍스트 정렬을 위한 스타일 (필요에 따라 조정) */
  .category-header, .subcategory-header {
    display: flex;
    align-items: center;
  }
  .toggle-btn {
    flex-shrink: 0; /* 버튼 크기 고정 */
  }
  .folder-icon {
    margin-left: 4px; /* 버튼과 폴더 아이콘 사이 간격 */
    /* flex-shrink: 0; */
  }
  .post-item {
    /* margin-left: 20px; 게시물 들여쓰기 */
  }
  .subcategory-item .subcategory-header {
    /* padding-left: 20px; */ /* 서브카테고리 들여쓰기용 패딩 */
  }
  .subcategory-item .posts-container {
    /* padding-left: 40px; */ /* 서브카테고리 내 게시물 들여쓰기용 패딩 */
  }
</style>

<div class="category-tree">
  <h2 class="tree-title">Category</h2>

  <div class="tree-container">
    
      <div class="category-item">
        <div class="category-header">
          <button class="toggle-btn" data-target="programming" aria-expanded="false" aria-controls="programming-container">
            <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="category-link">Programming</span>
        </div>

        <div class="subcategory-container" id="programming-container" style="display: none;">
          
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="oop" aria-expanded="false" aria-controls="oop-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">OOP</span>
                </div>

                <div class="posts-container" id="oop-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="fp" aria-expanded="false" aria-controls="fp-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">FP</span>
                </div>

                <div class="posts-container" id="fp-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="reactive" aria-expanded="false" aria-controls="reactive-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Reactive</span>
                </div>

                <div class="posts-container" id="reactive-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="tdd" aria-expanded="false" aria-controls="tdd-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">TDD</span>
                </div>

                <div class="posts-container" id="tdd-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="ddd" aria-expanded="false" aria-controls="ddd-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">DDD</span>
                </div>

                <div class="posts-container" id="ddd-container" style="display: none;">
                  
                  
                </div>
              </div>
            
          

          
          
        </div>
      </div>
    
      <div class="category-item">
        <div class="category-header">
          <button class="toggle-btn" data-target="language" aria-expanded="false" aria-controls="language-container">
            <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="category-link">Language</span>
        </div>

        <div class="subcategory-container" id="language-container" style="display: none;">
          
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="java" aria-expanded="false" aria-controls="java-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Java</span>
                </div>

                <div class="posts-container" id="java-container" style="display: none;">
                  
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/pecs/" class="post-link">PECS</a>
                    </div>
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/java-throwing-exception/" class="post-link">Java Throwing Exception</a>
                    </div>
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/scoped-values/" class="post-link">Scoped Values</a>
                    </div>
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/reference-type/" class="post-link">Reference Type</a>
                    </div>
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/forkjoinpool/" class="post-link">ForkJoinPool</a>
                    </div>
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="kotlin" aria-expanded="false" aria-controls="kotlin-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Kotlin</span>
                </div>

                <div class="posts-container" id="kotlin-container" style="display: none;">
                  
                  
                    <div class="post-item" style="margin-left: 20px;"> <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em; margin-right: 4px;">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                      </svg>
                      <a href="/blog/language/kotlin-coroutines/" class="post-link">Coroutines</a>
                    </div>
                  
                </div>
              </div>
            
          

          
          
        </div>
      </div>
    
      <div class="category-item">
        <div class="category-header">
          <button class="toggle-btn" data-target="framework" aria-expanded="false" aria-controls="framework-container">
            <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="category-link">Framework</span>
        </div>

        <div class="subcategory-container" id="framework-container" style="display: none;">
          
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="spring-boot" aria-expanded="false" aria-controls="spring-boot-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Spring Boot</span>
                </div>

                <div class="posts-container" id="spring-boot-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="spring-webflux" aria-expanded="false" aria-controls="spring-webflux-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Spring WebFlux</span>
                </div>

                <div class="posts-container" id="spring-webflux-container" style="display: none;">
                  
                  
                </div>
              </div>
            
          

          
          
        </div>
      </div>
    
      <div class="category-item">
        <div class="category-header">
          <button class="toggle-btn" data-target="database" aria-expanded="false" aria-controls="database-container">
            <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="category-link">Database</span>
        </div>

        <div class="subcategory-container" id="database-container" style="display: none;">
          
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="mysql" aria-expanded="false" aria-controls="mysql-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">MySQL</span>
                </div>

                <div class="posts-container" id="mysql-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="mongodb" aria-expanded="false" aria-controls="mongodb-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">MongoDB</span>
                </div>

                <div class="posts-container" id="mongodb-container" style="display: none;">
                  
                  
                </div>
              </div>
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="redis" aria-expanded="false" aria-controls="redis-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">Redis</span>
                </div>

                <div class="posts-container" id="redis-container" style="display: none;">
                  
                  
                </div>
              </div>
            
          

          
          
        </div>
      </div>
    
      <div class="category-item">
        <div class="category-header">
          <button class="toggle-btn" data-target="network" aria-expanded="false" aria-controls="network-container">
            <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span class="category-link">Network</span>
        </div>

        <div class="subcategory-container" id="network-container" style="display: none;">
          
            
              <div class="subcategory-item" style="margin-left: 20px;"> <div class="subcategory-header">
                  <button class="toggle-btn" data-target="tcp-ip" aria-expanded="false" aria-controls="tcp-ip-container">
                    <svg class="chevron-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                      <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                  </button>
                  <svg class="folder-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:1em; height:1em;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <span class="category-link">TCP/IP</span>
                </div>

                <div class="posts-container" id="tcp-ip-container" style="display: none;">
                  
                  
                </div>
              </div>
            
          

          
          
        </div>
      </div>
    
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // 토글 기능을 수행하는 함수
    function toggleContent(buttonElement) {
      const targetId = buttonElement.dataset.target + '-container';
      const targetContainer = document.getElementById(targetId);
      const icon = buttonElement.querySelector('.chevron-icon');
      const isExpanded = buttonElement.getAttribute('aria-expanded') === 'true';

      if (targetContainer) {
        if (isExpanded) {
          targetContainer.style.display = 'none';
          buttonElement.setAttribute('aria-expanded', 'false');
          if (icon) icon.style.transform = 'rotate(0deg)';
        } else {
          targetContainer.style.display = 'block'; // 또는 'flex' 등
          buttonElement.setAttribute('aria-expanded', 'true');
          if (icon) icon.style.transform = 'rotate(90deg)';
        }
      }
    }

    // 토글 버튼에 이벤트 리스너 추가
    const toggleButtons = document.querySelectorAll('.toggle-btn');
    toggleButtons.forEach(button => {
      button.addEventListener('click', function () {
        toggleContent(this);
      });
    });

    // 폴더 아이콘 및 카테고리/서브카테고리 이름에 클릭 이벤트 리스너 추가
    const clickableHeaders = document.querySelectorAll('.category-header, .subcategory-header');
    clickableHeaders.forEach(header => {
      const folderIcon = header.querySelector('.folder-icon');
      const categoryLink = header.querySelector('.category-link'); // span 태그
      const associatedToggleButton = header.querySelector('.toggle-btn');

      if (associatedToggleButton) { // 연관된 토글 버튼이 있을 경우에만
        if (folderIcon) {
          folderIcon.addEventListener('click', function() {
            toggleContent(associatedToggleButton);
          });
        }
        if (categoryLink) {
          categoryLink.addEventListener('click', function() {
            toggleContent(associatedToggleButton);
          });
        }
      }
    });

    // (선택 사항) 초기 상태에서 특정 카테고리 열기 (예: 첫 번째 주 카테고리)
    // const firstMainCategoryToggle = document.querySelector('.category-item > .category-header .toggle-btn');
    // if (firstMainCategoryToggle) {
    //    toggleContent(firstMainCategoryToggle); // 페이지 로드 시 열기
    // }
  });
</script>
      </aside>
      
      <main class="content">
        <article class="post">
  <header class="post-header">
    <h1 class="post-title">Coroutines</h1>
    <div class="post-meta">
      <div class="post-date">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        <time datetime="2024-05-26T00:00:00+09:00">2024년 05월 26일</time>
      </div>
      
      <div class="post-reading-time">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        
        
          10분 소요
        
      </div>
      
      
      <div class="post-categories-tags">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
          <line x1="7" y1="7" x2="7.01" y2="7"></line>
        </svg>
        <div class="tags-list">
          
            <a href="/blog/category/language" class="tag">language</a>
          
          
            <a href="/blog/tags/kotlin" class="tag">Kotlin</a>
          
            <a href="/blog/tags/coroutines" class="tag">Coroutines</a>
          
        </div>
      </div>
      
    </div>
  </header>

  <div class="post-content">
    <p>코틀린 진영에서의 자바 가상 스레드와 같은 경량 동시성 모델</p>

<h2 id="왜-코루틴을-사용해야-하는가">왜 코루틴을 사용해야 하는가?</h2>

<p>코틀린에서 비동기 프로그래밍을 하기 위해?(맞음)</p>

<p>비동기식 코드를 동기 방식으로 작성하기 위해(맞음) ⇒ 콜백지옥이 이제 없음(행복?)</p>

<ul>
  <li>코틀린 코루틴에선 콜백 스타일의 코드가 아닌 명령형 프로그래밍 스타일임.</li>
</ul>

<p>코루틴도 가상 스레드 처럼 OS 스레드에 직접 매핑되지 않고 <em>continuations</em>이라는 객체를 사용해 ULT에서 매핑이 이루어진다. (경량 스레드)</p>

<p>⇒ 코루틴 간 전환(CS)에서는 OS가 다른 스레드의 컨텍스트를 로드할 필요가 없지만 참조를 <em>continuations</em> 객체로 전환해야한다.</p>

<h2 id="비동기라면서-왜-반응형-프로그래밍을-안-함">비동기라면서 왜 반응형 프로그래밍을 안 함?</h2>

<p>반응형 프로그래밍에서의 코드를 작성하고 유지하려면 더욱 비용이 커지고, 복잡해진다.</p>

<ul>
  <li>대부분 FP 스타일로 작성되어 처음엔 보기 쉽겠지만, <code class="language-plaintext highlighter-rouge">subscribeOn</code>과 같이 실행 흐름을 다른 스레드로 넘겨 버리는 함수가 존재해 실행 흐름을 판단하기 어려울 것이고, 다 다른 스레드에서 작동된다면 당연히 예외 추적도 힘들 것이다.</li>
</ul>

<h2 id="suspend-키워드">Suspend 키워드?</h2>

<p>suspend 키워드는 코루틴에서 빠지면 안되는 기능이다.</p>

<p>해당 키워드를 메서드(함수)에 붙이게 된다면 해당 함수는 코루틴이라고 명시를 해줄 수 있고, 일시 중지를 할 수 있는 메서드라고 표시를 한다.</p>

<p>⇒ 일시 중지하고 언젠간? 재시작</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuIsComing</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 오고 있어요!"</span><span class="p">)</span> <span class="c1">// 함수 시작 point</span>
  <span class="nf">delay</span><span class="p">(</span><span class="mi">500L</span><span class="p">)</span> <span class="c1">// delay(timeMillis: Long) // 함수 중단 point</span>
  <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 도착했어요!"</span><span class="p">)</span> <span class="c1">// 함수 재개 point</span>
<span class="p">}</span>
</code></pre></div></div>

<p>minjuIsComing 코루틴이 실행될 때 delay 기능에서 일시 중지하고, 다시 재개를 한다.</p>

<p>해당 메커니즘을 자세히 소개 해주겟다</p>

<p>suspending 된 함수는 전체 문맥(context)가 <code class="language-plaintext highlighter-rouge">Continuation&lt;T&gt;</code>에 저장된다. 
Continuation 객체에는 함수의 변수 및 매개변수의 모든 상태, 실행이 중단된 지점(<strong>label</strong>)이 저장이 된다.</p>

<p>코틀린 컴파일러는 중지된 함수를 아래와 같이 재구성? 한다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuIsComing</span><span class="p">()</span>

<span class="k">fun</span> <span class="nf">minjuIsComing</span><span class="p">(</span><span class="n">continuation</span><span class="p">:</span> <span class="nc">Continuation</span><span class="p">&lt;</span><span class="err">*</span><span class="p">&gt;):</span> <span class="nc">Any</span> 
</code></pre></div></div>

<p>? 컴파일러 녀석이 왜 변환 값까지 바꾸나요.</p>

<p><code class="language-plaintext highlighter-rouge">suspend</code>함수가 일시 중지되면 함수 값을 반환할 수 없다.</p>

<p>하지만, 함수가 일시 중지되었음을 표시하는 값(<code class="language-plaintext highlighter-rouge">COROUTINE_SUSPENDED</code>)을 반환해야하기 때문에 반환 값이 바뀌는 것이다.</p>

<p>파라미터로 받는 continuation 객체에 해당 함수의 정보를 저장하기 위해 래핑을 한 번한다.</p>

<p>래핑을 해 생긴 continuation 객체의 이름은 <code class="language-plaintext highlighter-rouge">MinjuIsComingContinuation</code>이다.</p>

<ul>
  <li><em>**</em>정지 함수를 호출할 때마다 continuation 객체를 새 함수로 래핑을 한다.</li>
</ul>

<p>실행 정보를 저장하는 필드 label은 해당 함수가 처음 시작되면 0이고, 만약 0이라면 중단 함수를 만날 때까지 실행하다가 중단 함수(delay)를 만나 label은 1이 되고, 중단 함수를 실행 시키게 된다.</p>

<p>delay 함수가 <code class="language-plaintext highlighter-rouge">COROUTINE_SUSPENDED</code>를 반환하게 되면 해당 코루틴은 중지된 것으로 판단된다.</p>

<h2 id="dispatcher">Dispatcher</h2>

<p>coroutine에서 Thread에 코루틴을 전달하는 스케줄러 역할을 한다.</p>

<h1 id="structured-concurrency">Structured Concurrency</h1>

<h2 id="coroutine-scope">Coroutine <strong>S</strong>cope</h2>

<p>coroutineScope는 구조적 동시성을 구현한다.</p>

<ul>
  <li>상위 코루틴이 취소되면 하위 코루틴도 취소</li>
  <li>하위 코루틴이 예외를 발생시키면 상위 코루틴도 중지</li>
</ul>

<p>coroutineScope는 실행이 끝날 때까지 이전 코루틴의 실행을 일시 중단하는 새로운 코루틴을 생성한다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutine</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">minjuIsComing</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">minjuIsGoing</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuIsComing</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 오고 있어요!"</span><span class="p">)</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">500L</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 도착했어요!"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuIsGoing</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 가고 있어요ㅜㅜ"</span><span class="p">)</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000L</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 가버렸어요ㅜㅜ"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17:23:26.285 [main] INFO **MainLogger** - start
17:23:26.378 [**main**] INFO Example - 민주가 오고 있어요!
17:23:27.013 [kotlinx.coroutines.DefaultExecutor] INFO Example - 민주가 도착했어요!
17:23:27.031 [kotlinx.coroutines.DefaultExecutor] INFO Example - 민주가 가고 있어요ㅜㅜ
17:23:28.041 [kotlinx.coroutines.DefaultExecutor] INFO Example - 민주가 가버렸어요ㅜㅜ
17:23:28.056 [kotlinx.coroutines.**DefaultExecutor**] INFO **MainLogger** - end
</code></pre></div></div>

<p>실행은 순전히 순차적이다. 하지만 런타임은 두 개의 서로 다른 스레드를 사용해 전체 프로세스를 실행한다.</p>

<p>코루틴에서 중단이 되었다 다시 재개할 때 중단 되었던 스레드에서 다시 시작한다는 보장이 없다.</p>

<p>⇒ 재개할 시엔 다른 스레드에서 실행될 수 있다.</p>

<h2 id="coroutine-builder">Coroutine Builder</h2>

<p>코루틴을 생성할 수 있다.</p>

<h3 id="launch-builder"><strong>Launch</strong> Builder</h3>

<p>특정 코드를 실행하지만, 그 결과값이 필요없을 때 사용된다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutine</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuIsComing</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuIsGoing</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18:44:54.289 [main] INFO MainLogger - start
18:44:54.856 [DefaultDispatcher-worker-1] INFO Example - 민주가 오고 있어요!
18:44:54.961 [DefaultDispatcher-worker-2] INFO Example - 민주가 가고 있어요ㅜㅜ
18:44:55.554 [DefaultDispatcher-worker-2] INFO Example - 민주가 도착했어요!
18:44:56.042 [DefaultDispatcher-worker-2] INFO Example - 민주가 가버렸어요ㅜㅜ
18:44:56.043 [DefaultDispatcher-worker-2] INFO MainLogger - end
</code></pre></div></div>

<p>위의 실행 결과 처럼 하나의 스코프 안에서 두 개의 코루틴을 동시에 실행한다. 두 개의 worker 스레드를 이용하여 처리한 것을 볼 수 있다.</p>

<ul>
  <li>두 코루틴은 동일한 범위의 하위 항목이므로 두 코루틴 모두 실행이 끝날 때까지 기다린 후 반환</li>
</ul>

<p><strong>GlobalScope</strong></p>

<p>GlobalScope를 사용해 구조적 동시성 사용을 피할 수 있다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineGlobal</span><span class="p">()</span> <span class="p">{</span>
    <span class="nc">GlobalScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
        <span class="nf">minjuIsComing</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="nc">GlobalScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
        <span class="nf">minjuIsGoing</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="nc">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1500L</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18:56:07.017 [main] INFO MainLogger - start
18:56:07.409 [DefaultDispatcher-worker-1] INFO Example - 민주가 가고 있어요ㅜㅜ
18:56:07.409 [DefaultDispatcher-worker-3] INFO Example - 민주가 오고 있어요!
18:56:07.947 [DefaultDispatcher-worker-1] INFO Example - 민주가 도착했어요!
18:56:08.448 [DefaultDispatcher-worker-1] INFO Example - 민주가 가버렸어요ㅜㅜ
18:56:08.908 [main] INFO MainLogger - end
</code></pre></div></div>

<p>하지만, 이 경우엔 코루틴 실행이 끝날 때까지 약간의 대기 시간을 추가 해야한다.
(delay(1500L) 또는Thread.sleep(1500L)..)</p>

<ul>
  <li>부모-자식 관계를 강제하지 않는 빈 코루틴 범위와 같다.</li>
</ul>

<p><strong>Job</strong></p>

<p>launch 함수를 사용하면 Job을 반환한다.</p>

<ul>
  <li>Job은 <strong>코루틴에 대한 핸들러이다.</strong></li>
  <li>이를 사용하여 코루틴 실행을 취소하거나 완료될 때까지 기다릴 수 있다.</li>
</ul>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineJob</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">minjuIsComingJob</span><span class="p">:</span> <span class="nc">Job</span> <span class="p">=</span> <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuIsComing</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="kd">val</span>  <span class="py">minjuIsGoingJob</span><span class="p">:</span> <span class="nc">Job</span> <span class="p">=</span> <span class="nf">launch</span> <span class="p">{</span>
             <span class="nf">minjuIsGoing</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">minjuIsComingJob</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
        <span class="n">minjuIsGoingJob</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuStartAndEnd</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>19:07:23.041 [main] INFO MainLogger - start
19:07:23.530 [DefaultDispatcher-worker-1] INFO Example - 민주가 오고 있어요!
19:07:23.548 [DefaultDispatcher-worker-2] INFO Example - 민주가 가고 있어요ㅜㅜ
19:07:24.145 [DefaultDispatcher-worker-1] INFO Example - 민주가 도착했어요!
19:07:24.627 [DefaultDispatcher-worker-1] INFO Example - 민주가 가버렸어요ㅜㅜ
19:07:24.648 [DefaultDispatcher-worker-2] INFO Example - 민주가 시작했어요!
19:07:25.163 [DefaultDispatcher-worker-2] INFO Example - 민주가 끝났어요!
19:07:25.164 [DefaultDispatcher-worker-2] INFO MainLogger - end
</code></pre></div></div>

<p>스코프 내의 3개의 코루틴이 동시에 실행될 것 같지만 아니다.</p>

<p>로그를 확인해 보면 minjuStartAndEnd는 나머지 두 개의 코루틴이 끝나고서야 실행되는 것을 확인할 수 있다.</p>

<p>이것이 구조적 동시성이다.</p>

<p>위의 코드에선 Job 객체를 통해 Join을 해주어 구조적 동시성을 달성했지만, 우리는 코드를 어떻게 바꿔야할 지 알고 있다</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineJob</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">coroutineScope</span> <span class="p">{</span>
            <span class="nf">launch</span> <span class="p">{</span>
                <span class="nf">minjuIsComing</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="nf">launch</span> <span class="p">{</span>
                <span class="nf">minjuIsGoing</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuStartAndEnd</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>19:14:55.673 [main] INFO MainLogger - start
19:14:55.854 [DefaultDispatcher-worker-1] INFO Example - 민주가 오고 있어요!
19:14:55.861 [DefaultDispatcher-worker-2] INFO Example - 민주가 가고 있어요ㅜㅜ
19:14:56.412 [DefaultDispatcher-worker-2] INFO Example - 민주가 도착했어요!
19:14:56.906 [DefaultDispatcher-worker-2] INFO Example - 민주가 가버렸어요ㅜㅜ
19:14:56.911 [DefaultDispatcher-worker-2] INFO Example - 민주가 시작했어요!
19:14:57.413 [DefaultDispatcher-worker-2] INFO Example - 민주가 끝났어요!
19:14:57.413 [DefaultDispatcher-worker-2] INFO MainLogger - end
</code></pre></div></div>

<p>coroutineScope를 사용해 같은 결과를 얻을 수 있다.</p>

<h3 id="async-builder"><strong>Async Builder</strong></h3>

<p>코루틴 실행에서 결과 값을 반환해야할 때 사용한다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minju</span><span class="p">():</span> <span class="nc">String</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주 생성 중~~"</span><span class="p">)</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">500L</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"생성 완료!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">"민주"</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">findMinju</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주 찾는 중~~"</span><span class="p">)</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000L</span><span class="p">)</span>
    <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"찾았습니다!"</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">511</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineAsync</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">minju</span><span class="p">:</span> <span class="nc">Deferred</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nf">async</span> <span class="p">{</span>
            <span class="nf">minju</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="kd">val</span> <span class="py">findMinju</span><span class="p">:</span> <span class="nc">Deferred</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nf">async</span> <span class="p">{</span>
            <span class="nf">findMinju</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"${minju.await()}를 ${findMinju.await()}일 만에 찾았습니다!"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>20:30:35.294 [main] INFO MainLogger - start
20:30:35.459 [DefaultDispatcher-worker-1] INFO Example - 민주 생성 중~~
20:30:35.476 [DefaultDispatcher-worker-2] INFO Example - 민주 찾는 중~~
20:30:36.004 [DefaultDispatcher-worker-1] INFO Example - 생성 완료!
20:30:36.499 [DefaultDispatcher-worker-1] INFO Example - 찾았습니다!
20:30:36.501 [DefaultDispatcher-worker-1] INFO Example - 민주를 511일 만에 찾았습니다!
20:30:36.501 [DefaultDispatcher-worker-1] INFO MainLogger - end
</code></pre></div></div>

<p>Deferred 변수에 async 실행 결과를 저장하고, await을 통해 값을 가져온다.(기다린다)</p>

<h1 id="cancellation">Cancellation</h1>

<p>코루틴 실행을 취소해보자</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">cancelMinjuRoutine</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span> 
        <span class="kd">val</span> <span class="py">minjuJob</span><span class="p">:</span> <span class="nc">Job</span> <span class="p">=</span> <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">minjuIsComing</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mi">400L</span><span class="p">)</span>
            <span class="n">minjuJob</span><span class="p">.</span><span class="nf">cancel</span><span class="p">()</span>
            <span class="n">minjuJob</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
            <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"민주가 사라졌어요.."</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>16:49:58.741 [main] INFO MainLogger - start
16:49:59.027 [DefaultDispatcher-worker-1] INFO Example - 민주가 오고 있어요!
16:49:59.483 [DefaultDispatcher-worker-1] INFO Example - 민주가 사라졌어요..
16:49:59.484 [DefaultDispatcher-worker-1] INFO MainLogger - end
</code></pre></div></div>

<p>민주가 오다가 사라져버린다.. 이 얼마나 안타까운 일인가;;</p>

<p>Job 또는 Deferred 클래스에서 cancel 함수를 구현해 코루틴을 취소할 수 있다.</p>

<p>하지만 코루틴의 실행을 취소 시키려면 일시 중지(delay)가 무조건 필요하다.</p>

<p>단순히 cancel만 사용하게 된다면, 해당 코루틴은 <strong>즉시 중지되지 않고,</strong> 계속 실행될 수 있다.</p>

<ul>
  <li>cancel 함수는 <strong>취소 중</strong>이라는 상태를 나타낸다.</li>
</ul>

<p>이런 실행 취소 신호(CancellationException)를 보내 감지를 해야하는데, 일시 중지 상태에서 해당 코루틴이 취소된 것을 알 수 있다.</p>

<p>cancel-join은 일반적인 패턴이라 Job.cancelAndJoin()을 통해 결합된 함수를 사용할 수 있다.</p>

<p>코루틴의 취소는 하위 코루틴까지 전파가 된다(코드는 따로 안 줄거임)</p>

<p>⇒ 코루틴을 취소하면 모든 자식이 암시적으로 취소가 됌</p>

<h1 id="coroutine-context">Coroutine Context</h1>

<p>상위 코루틴으로부터 하위 코루틴에게 전달된 정보를 저장하여 내부적으로 구조적 동시성을 달성하는 방법</p>

<ul>
  <li>CoroutineScope는 Coroutine context 참조를 유지한다.</li>
</ul>

<p>⇒ 자식까지 전염된다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineContext</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">launch</span><span class="p">(</span><span class="nc">CoroutineName</span><span class="p">(</span><span class="s">"아일릿-민주"</span><span class="p">)</span> <span class="p">+</span> <span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"Hello, Minju!"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17:05:15.688 [DefaultDispatcher-worker-1 @**아일릿-민주**#1] INFO Example - Hello, Minju!
</code></pre></div></div>

<p>해당 로그에서 코루틴이 지정된 이름으로 생성되고, 실행되는 것을 확인할 수 있다.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">suspend</span> <span class="k">fun</span> <span class="nf">minjuRoutineContext</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">launch</span><span class="p">(</span><span class="nc">CoroutineName</span><span class="p">(</span><span class="s">"아일릿-민주"</span><span class="p">)</span> <span class="p">+</span> <span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"Hello, Minju!"</span><span class="p">)</span>
            <span class="nf">launch</span> <span class="p">{</span>
                <span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s">"Lovely Minju!"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>17:09:45.482 [main] INFO MainLogger - start
17:09:45.699 [DefaultDispatcher-worker-1 **@아일릿-민주#1**] INFO Example - Hello, Minju!
17:09:45.711 [DefaultDispatcher-worker-2 **@아일릿-민주#2**] INFO Example - Lovely Minju!
17:09:45.712 [DefaultDispatcher-worker-2 **@아일릿-민주#2**] INFO MainLogger - end
</code></pre></div></div>

<p>하위 코루틴까지 Context Name이 전염(전달)되는 것을 확인할 수 있다.</p>

  </div>

  
  <div class="related-posts">
    <h2>관련 글</h2>
    <ul>
      
        <li>
          <a href="/blog/language/pecs/">PECS</a>
          <small>2024년 07월 28일</small>
        </li>
      
        <li>
          <a href="/blog/language/java-throwing-exception/">Java Throwing Exception</a>
          <small>2024년 06월 17일</small>
        </li>
      
        <li>
          <a href="/blog/language/scoped-values/">Scoped Values</a>
          <small>2024년 05월 26일</small>
        </li>
      
    </ul>
  </div>
  

</article>

      </main>
    </div>
    
    <footer class="site-footer">
  <div class="footer-container">
    <div class="footer-content">
      <p>&copy; 2025 Seungwon. All rights reserved.</p>
    </div>
    <div class="footer-links">
      
      <a href="https://github.com/ori0o0p" target="_blank" rel="noopener noreferrer">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
        </svg>
      </a>
      
      <a href="/blog/feed.xml">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 11a9 9 0 0 1 9 9"></path>
          <path d="M4 4a16 16 0 0 1 16 16"></path>
          <circle cx="5" cy="19" r="1"></circle>
        </svg>
      </a>
    </div>
  </div>
</footer>

  </div>

  <script src="/blog/assets/js/category-tree.js"></script>
  <script src="/blog/assets/js/mobile-menu.js"></script>
</body>
</html>
